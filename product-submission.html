<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Submit a Product - SmartDeals Pro</title>
  <meta name="description" content="Submit your product to be featured on SmartDeals Pro." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="style.css" />
  <!-- Inline styles specific to the submission form -->
  <style>
    body {
      background: #f5f7fa;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 2rem 1rem;
      font-family: Arial, Helvetica, sans-serif;
    }
    .card {
      background: #fff;
      width: 100%;
      max-width: 500px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 2rem 1.5rem;
    }
    h1 {
      margin-bottom: 1.5rem;
      text-align: center;
      color: #333;
      font-size: 1.8rem;
    }
    .form-group {
      margin-bottom: 1rem;
      display: flex;
      flex-direction: column;
    }
    label {
      margin-bottom: 0.4rem;
      color: #555;
      font-weight: 600;
    }
    input[type="text"],
    input[type="url"],
    input[type="number"],
    input[type="email"],
    textarea {
      padding: 0.55rem 0.75rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    textarea {
      resize: vertical;
      min-height: 100px;
    }
    input[type="file"] {
      padding: 0.4rem 0;
    }
    .btn {
      width: 100%;
      padding: 0.75rem;
      margin-top: 1rem;
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .btn:hover {
      background: #1d4ed8;
    }
    .error {
      color: #dc2626;
      margin-top: 0.25rem;
      font-size: 0.9rem;
    }
    @media (max-width: 480px) {
      .card {
        padding: 1.5rem 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Header (simplified) -->
  <header class="main-header" style="width:100%;">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <a href="index.html" class="logo-link">
            <img src="logo.png" alt="SmartDeals Pro Logo" class="logo" />
            <span class="logo-text">SmartDeals Pro</span>
          </a>
        </div>
        <nav class="main-nav">
          <ul>
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li class="dropdown">
              <a href="#" class="nav-link dropdown-toggle">Categories <i class="fas fa-chevron-down"></i></a>
              <ul class="dropdown-menu">
                <li><a href="smartwatches.html">Smartwatches</a></li>
                <li><a href="fashion.html">Fashion</a></li>
                <li><a href="small-electrical.html">Electronics</a></li>
                <li><a href="gaming.html">Gaming</a></li>
                <li><a href="home-garden.html">Home & Garden</a></li>
                <li><a href="product-submission.html">Submit Product</a></li>
              </ul>
            </li>
            <li><a href="reviews.html" class="nav-link">Reviews</a></li>
            <li><a href="deals.html" class="nav-link">Hot Deals</a></li>
            <li><a href="about.html" class="nav-link">About</a></li>
            <li><a href="contact.html" class="nav-link">Contact</a></li>
            <li><a href="product-submission.html" class="nav-link active">Submit Product</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <!-- Submission Form -->
  <div class="card">
    <h1>Product Submission</h1>
    <form id="productForm" novalidate>
      <div class="form-group">
        <label for="productTitle">Product Title</label>
        <input type="text" id="productTitle" required />
        <span class="error" id="titleError"></span>
      </div>

      <div class="form-group">
        <label for="productImage">Image Upload</label>
        <input type="file" id="productImage" accept="image/*" required />
        <span class="error" id="imageError"></span>
      </div>

      <div class="form-group">
        <label for="price">Price (USD)</label>
        <input type="number" step="0.01" id="price" required />
        <span class="error" id="priceError"></span>
      </div>

      <!-- Category Selection -->
      <div class="form-group">
        <label for="category">Category</label>
        <select id="category" required>
          <option value="">Select Category</option>
          <option value="smartwatch">Smartwatches</option>
          <option value="fashion">Fashion</option>
          <option value="electrical">Electronics</option>
          <option value="gaming">Gaming</option>
          <option value="home-garden">Home & Garden</option>
        </select>
        <span class="error" id="categoryError"></span>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" required></textarea>
        <span class="error" id="descriptionError"></span>
      </div>

      <div class="form-group">
        <label for="productLink">Product Link</label>
        <input type="url" id="productLink" placeholder="https://example.com" required />
        <span class="error" id="linkError"></span>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" required />
        <span class="error" id="emailError"></span>
      </div>

      <button type="submit" class="btn">Submit Product</button>
    </form>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script>
    // TODO: Replace with your Firebase credentials
    const firebaseConfig = {
      apiKey: "AIzaSyBJqBEWDdBlfv5xAjgcvqput1KC1NzKvlU",
      authDomain: "smart-deals-pro.firebaseapp.com",
      projectId: "smart-deals-pro",
      storageBucket: "smart-deals-pro.firebasestorage.app",
      messagingSenderId: "680016915696",
      appId: "1:680016915696:web:4b3721313ea0e2e3342635",
      measurementId: "G-HV5N0LQJTG"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <!-- Validation Script -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("productForm");
      const allowedEmail = "mrazwan0310@gmail.com";

      const errors = {
        title: document.getElementById("titleError"),
        image: document.getElementById("imageError"),
        price: document.getElementById("priceError"),
        category: document.getElementById("categoryError"),
        description: document.getElementById("descriptionError"),
        link: document.getElementById("linkError"),
        email: document.getElementById("emailError"),
      };

      function clearErrors() {
        Object.values(errors).forEach((el) => (el.textContent = ""));
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        clearErrors();

        const title = document.getElementById("productTitle").value.trim();
        const imageInput = document.getElementById("productImage");
        const price = document.getElementById("price").value.trim();
        const description = document.getElementById("description").value.trim();
        const link = document.getElementById("productLink").value.trim();
        const email = document.getElementById("email").value.trim();
        const category = document.getElementById("category").value;

        let valid = true;

        if (!title) {
          errors.title.textContent = "Product title is required.";
          valid = false;
        }

        if (!imageInput.files[0]) {
          errors.image.textContent = "Please upload an image.";
          valid = false;
        }

        if (!price) {
          errors.price.textContent = "Please enter a price.";
          valid = false;
        }

        if (!description) {
          errors.description.textContent = "Description is required.";
          valid = false;
        }

        if (!link) {
          errors.link.textContent = "Product link is required.";
          valid = false;
        }

        if (email !== allowedEmail) {
          errors.email.textContent = "Invalid email address.";
          valid = false;
        }

        if (!category) {
          errors.category.textContent = "Please select a category.";
          valid = false;
        }

        if (!valid) {
          return;
        }

        const file = imageInput.files[0];
        const reader = new FileReader();

        reader.onload = function () {
          const imageData = reader.result; // base64 encoded image

          const product = {
            title,
            imageData,
            price,
            description,
            link,
            category,
            rating: 5,
            reviews: 0,
            featured: true,
            createdAt: Date.now(),
          };

          db.collection("products")
            .add(product)
            .then(() => {
              // Keep a local copy for offline support
              const existing = JSON.parse(localStorage.getItem("products") || "[]");
              existing.push(product);
              localStorage.setItem("products", JSON.stringify(existing));

              // Redirect to the product list page
              window.location.href = "products.html";
            })
            .catch((err) => {
              console.error("Failed to submit product:", err);
              alert("Sorry, we couldn't save your product right now. Please try again later.");
            });
        };

        reader.readAsDataURL(file);
      });
    });
  </script>
</body>
</html>